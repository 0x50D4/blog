<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="PicoCTF 2023 - PowerAnalysis: Part 1" /><meta property="og:locale" content="en" /><meta name="description" content="Here is the description of the challenge:" /><meta property="og:description" content="Here is the description of the challenge:" /><link rel="canonical" href="https://0x50d4.github.io/blog/posts/pico-power-1/" /><meta property="og:url" content="https://0x50d4.github.io/blog/posts/pico-power-1/" /><meta property="og:site_name" content="0x50D4" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-10T01:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PicoCTF 2023 - PowerAnalysis: Part 1" /><meta name="twitter:site" content="@sodasec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-10T10:38:21+02:00","datePublished":"2023-04-10T01:00:00+02:00","description":"Here is the description of the challenge:","headline":"PicoCTF 2023 - PowerAnalysis: Part 1","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x50d4.github.io/blog/posts/pico-power-1/"},"url":"https://0x50d4.github.io/blog/posts/pico-power-1/"}</script><title>PicoCTF 2023 - PowerAnalysis: Part 1 | 0x50D4</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0x50D4"><meta name="application-name" content="0x50D4"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" class="mx-auto"> <img src="/blog/assets/img/commons/cropped.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/blog/">0x50D4</a></div><div class="site-subtitle font-italic">A cyber security blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/0x50D4" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/sodasec" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['sodasec','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/blog/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/blog/"> Home </a> </span> <span>PicoCTF 2023 - PowerAnalysis: Part 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>PicoCTF 2023 - PowerAnalysis: Part 1</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1681081200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 10, 2023 </em> </span> <span> Updated <em class="" data-ts="1681115901" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 10, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/sodasec">0x50D4</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1537 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>Here is the description of the challenge:</p><p><a href="https://lh3.googleusercontent.com/ZPdwS0_7vlFhVhKnmIwFqrf9wK3Ja-2cxli3QxLFAQl-uznBG6mtB1JWYv5ZwjwuI0mDcloRERoMLVYKT2ddANnoCnCwJw1zRG71bm-ZPtIrjbI2aJ2OfeATCsjZ1i83l4NDhnJV" class="popup img-link "><img data-src="https://lh3.googleusercontent.com/ZPdwS0_7vlFhVhKnmIwFqrf9wK3Ja-2cxli3QxLFAQl-uznBG6mtB1JWYv5ZwjwuI0mDcloRERoMLVYKT2ddANnoCnCwJw1zRG71bm-ZPtIrjbI2aJ2OfeATCsjZ1i83l4NDhnJV" alt="Description" class="lazyload" data-proofer-ignore></a></p><p>Before this I knew nothing about cryptography basically, and had no idea what power analysis was so I knew this is going to be a hard one. So I did what everyone would do in this case, looked up power analysis, what it is, how it works.</p><p>One of the things I found was <a href="https://github.com/Nodulaire/SCA-DPA">this</a> link, this pretty much explains what power analysis is, basically, when encrypting something with AES, the power consumption is different when it does different tasks, and we can figure out what keys it uses for encryption. This requires us to have a lot of data. In any other case, we would need an oscilloscope, but in this case, we can just retrieve data from the instance we can launch. So, we have two tasks</p><ul><li>retrieve enough data for power analysis<li>somehow do power analysis</ul><p>If we want to do power analysis, we need to figure out in what format we have to save the data, and since there is no way I’m writing a script myself for power analysis, let’s find one, hopefully in python.</p><p>I found <a href="https://github.com/JayKaku/esCTF-round2-2022">this link</a> which is a writeup of another CTF, containing a script named <strong>power.py</strong>, which does exactly what we need, here is how it looks:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="c1"># source: https://github.com/newaetech/chipwhisperer-jupyter/blob/master/courses/sca101/SOLN_Lab%204_2%20-%20CPA%20on%20Firmware%20Implementation%20of%20AES.ipynb
</span>
<span class="kn">import</span> <span class="n">numpy</span>

<span class="n">sbox</span> <span class="o">=</span> <span class="p">[</span>
	<span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x7c</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> 
	<span class="mh">0xca</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0xaf</span><span class="p">,</span> <span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> 
	<span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> 
	<span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> 
	<span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> 
	<span class="mh">0x53</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> 
	<span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> 
	<span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> 
	<span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> 
	<span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> 
	<span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0xc2</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> 
	<span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> 
	<span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> 
	<span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> 
	<span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> 
	<span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0x16</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">aes_internal</span><span class="p">(</span><span class="n">inputdata</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">sbox</span><span class="p">[</span><span class="n">inputdata</span> <span class="o">^</span> <span class="n">key</span><span class="p">]</span>

<span class="n">HW</span> <span class="o">=</span> <span class="p">[</span><span class="nf">bin</span><span class="p">(</span><span class="n">n</span><span class="p">).</span><span class="nf">count</span><span class="p">(</span><span class="s">"1"</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">std_dev</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X_bar</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="nf">sum</span><span class="p">((</span><span class="n">X</span><span class="o">-</span><span class="n">X_bar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">cov</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X_bar</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Y_bar</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">sum</span><span class="p">((</span><span class="n">X</span><span class="o">-</span><span class="n">X_bar</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Y</span><span class="o">-</span><span class="n">Y_bar</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">textin_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="s">"textin_array.npy"</span><span class="p">)</span>
<span class="n">trace_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="s">"trace_array.npy"</span><span class="p">)</span>

<span class="n">t_bar</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">trace_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">trace_array</span><span class="p">)</span>
<span class="n">o_t</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="nf">sum</span><span class="p">((</span><span class="n">trace_array</span> <span class="o">-</span> <span class="n">t_bar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">16</span>
<span class="k">for</span> <span class="n">bnum</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">):</span>
	<span class="n">maxcpa</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
	<span class="k">for</span> <span class="n">kguess</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
		<span class="n">hws</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">array</span><span class="p">([[</span><span class="n">HW</span><span class="p">[</span><span class="nf">aes_internal</span><span class="p">(</span><span class="n">textin</span><span class="p">[</span><span class="n">bnum</span><span class="p">],</span><span class="n">kguess</span><span class="p">)]</span> <span class="k">for</span> <span class="n">textin</span> <span class="ow">in</span> <span class="n">textin_array</span><span class="p">]]).</span><span class="nf">transpose</span><span class="p">()</span>
		<span class="n">hws_bar</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">hws</span><span class="p">)</span>
		<span class="n">o_hws</span> <span class="o">=</span> <span class="nf">std_dev</span><span class="p">(</span><span class="n">hws</span><span class="p">,</span> <span class="n">hws_bar</span><span class="p">)</span>
		<span class="n">correlation</span> <span class="o">=</span> <span class="nf">cov</span><span class="p">(</span><span class="n">trace_array</span><span class="p">,</span> <span class="n">t_bar</span><span class="p">,</span> <span class="n">hws</span><span class="p">,</span> <span class="n">hws_bar</span><span class="p">)</span>
		<span class="n">cpaoutput</span> <span class="o">=</span> <span class="n">correlation</span><span class="o">/</span><span class="p">(</span><span class="n">o_t</span><span class="o">*</span><span class="n">o_hws</span><span class="p">)</span>
		<span class="n">maxcpa</span><span class="p">[</span><span class="n">kguess</span><span class="p">]</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">cpaoutput</span><span class="p">))</span>
	<span class="n">key</span><span class="p">[</span><span class="n">bnum</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">maxcpa</span><span class="p">)</span>
	<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"found byte </span><span class="si">{</span><span class="n">bnum</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"key: </span><span class="si">{</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="mi">02</span><span class="n">x</span><span class="si">}</span><span class="s">' for b in key)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

</pre></table></code></div></div><p>Kinda a lot to take in, but we don’t have to understand everything to make this work. What we need is somehow figure out how to make our data so it can be used by this script. We can see that is uses <code class="language-plaintext highlighter-rouge">numpy</code> which is a python library used for quick access of data for example. Here is the line we are concerned about:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">textin_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="s">"textin_array.npy"</span><span class="p">)</span>
<span class="n">trace_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="s">"trace_array.npy"</span><span class="p">)</span>
</pre></table></code></div></div><p>So, let’s download the two files in the example and let’s see what kind of data is it, let’s try using <code class="language-plaintext highlighter-rouge">cat</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>❯ cat trace_array.npy  
�NUMPYv{'descr': '&lt;i8', 'fortran_order': False, 'shape': (500, 2666), }                                                     
�rfS2MEX7Wml[aW^5VU^K&lt;(!"984#*\uC@XSO,ISxcdMvW\&lt;bj����tZ:5&gt;JA,)EZ_Ugt�SonlQ'VIJ&amp;(6JD`hgU2RDON`vhnM]Ti]&gt;LYzmrbJTUmgylYO=QV}U?1c[f;@:U^=6XbN@by�WZNR6 ?i��^:1&lt;lqp[;.5@fT{Ra[svar�sfGcLmfu^W]Snz��x]=42-9QN&lt;@Y���\KTbp���vpa~���~g&gt;On��j�gvQzZmiol]z���hZDVl�lR&lt;JM]reePgt��T9&gt;q�}TTVW9Xjr?%"&amp;15NP`h�p|~���������������������������������������������������������������������������������������������������������zs��������v�������z������������������������z����������|������������������`Qo����������l���|����������������x�������������������������� 
[...]
</pre></table></code></div></div><p>Well, this is not really useful. Let’s try loading it and printing it out with python instead.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>
<span class="err">❯</span> <span class="n">python3</span>               
<span class="n">Python</span> <span class="mf">3.10</span><span class="p">.</span><span class="mi">10</span> <span class="p">(</span><span class="n">main</span><span class="p">,</span> <span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">2023</span><span class="p">,</span> <span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">53</span><span class="p">)</span> <span class="p">[</span><span class="n">GCC</span> <span class="mf">12.2</span><span class="p">.</span><span class="mi">1</span> <span class="mi">20230201</span><span class="p">]</span> <span class="n">on</span> <span class="n">linux</span>
<span class="n">Type</span> <span class="s">"help"</span><span class="p">,</span> <span class="s">"copyright"</span><span class="p">,</span> <span class="s">"credits"</span> <span class="ow">or</span> <span class="s">"license"</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="p">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">numpy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">trace_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="s">"trace_array.npy"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">print</span><span class="p">(</span><span class="n">trace_array</span><span class="p">)</span>
<span class="p">[[</span><span class="mi">143</span> <span class="mi">127</span> <span class="mi">114</span> <span class="p">...</span> <span class="mi">250</span> <span class="mi">227</span> <span class="mi">228</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">103</span>  <span class="mi">66</span>  <span class="mi">40</span> <span class="p">...</span> <span class="mi">259</span> <span class="mi">271</span> <span class="mi">194</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">142</span> <span class="mi">139</span> <span class="mi">116</span> <span class="p">...</span> <span class="mi">141</span> <span class="mi">200</span> <span class="mi">244</span><span class="p">]</span>
 <span class="p">...</span>
 <span class="p">[</span><span class="mi">105</span>  <span class="mi">89</span> <span class="mi">107</span> <span class="p">...</span> <span class="mi">207</span> <span class="mi">208</span> <span class="mi">231</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">70</span>  <span class="mi">72</span>  <span class="mi">71</span> <span class="p">...</span> <span class="mi">251</span> <span class="mi">227</span> <span class="mi">273</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">116</span> <span class="mi">127</span> <span class="mi">106</span> <span class="p">...</span> <span class="mi">199</span> <span class="mi">226</span> <span class="mi">236</span><span class="p">]]</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">npy</code> files are actually so called 2 dimensional arrays, when we ask python to print it, it doesn’t print the whole thing, it only prints the starts and ends of the arrays, and only the first and last 3 ones. So, what did we learn with this? well, we will need to make a 2d array and convert it to <code class="language-plaintext highlighter-rouge">npy</code> somehow.</p><p>So this is useful, but we still need to somehow get the data that we can convert someohw, let’s look at what our instance does:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>❯ nc saturn.picoctf.net 50306
Please provide 16 bytes of plaintext encoded as hex: 
</pre></table></code></div></div><p>Pretty straigh forward, let’s see what it does if we do this:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>❯ nc saturn.picoctf.net 50306
Please provide 16 bytes of plaintext encoded as hex: 61616161616161616161616161616161
power measurement result:  [88, 70, 97, 106, 146, 159, 139, 112, 106, 122, 142, 146, 131,      ...      207, 156, 162, 169, 132, 143, 187, 239, 280, 312, 299, 291, 264, 228, 233, 241, 272, 227, 225, 193, 221, 242, 263, 263, 181, 207, 188, 204, 159, 197, 212, 215]
</pre></table></code></div></div><p>we can see it returns a loooong array of numbers, (the dots are included by me, the returned array is much longer).</p><p>Now that we know how we get the data and what we have to turn it into, let’s write a script:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">string</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">numpy</span>

<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</pre></table></code></div></div><p>Let’s import everything we might need, we will see where we use these things. We could use sockets to connect to the server but it’s easier with <code class="language-plaintext highlighter-rouge">pwn</code>.</p><p>We have 2 arrays that we will need, one for the input text, and one for the array that we get:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">main_trace_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">main_input_array</span> <span class="o">=</span> <span class="p">[]</span>
</pre></table></code></div></div><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">letters</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span>
<span class="n">ip</span> <span class="o">=</span> <span class="s">"saturn.picoctf.net"</span>
<span class="n">port</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Port: "</span><span class="p">))</span>
</pre></table></code></div></div><p>first we get all the letters that we will randomly choose from for out inputs, then, since the ip is always the same we can just hardcode the domain name there, and since the port is changing we can ask that from the user to input.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">):</span>

    <span class="n">rand_string</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>

    <span class="n">int_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rand_string</span><span class="p">:</span>
        <span class="n">int_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="n">conn</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="n">conn</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>

    <span class="n">rand_string</span> <span class="o">=</span> <span class="n">rand_string</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">).</span><span class="nf">hex</span><span class="p">()</span>
    <span class="n">bytes_string</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">rand_string</span><span class="p">,</span> <span class="s">'utf-8'</span><span class="p">)</span>

    <span class="n">conn</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">bytes_string</span><span class="p">)</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">recvall</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
    <span class="n">conn</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

    <span class="n">trace_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">trace_string</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">findall</span><span class="p">(</span><span class="s">"([0-9]+)"</span><span class="p">,</span> <span class="nf">str</span><span class="p">(</span><span class="n">answer</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">trace_string</span><span class="p">:</span>
        <span class="n">trace_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">main_trace_array</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">trace_list</span><span class="p">)</span>
    <span class="n">main_input_array</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">int_list</span><span class="p">)</span>
</pre></table></code></div></div><p>Then comes the loop, we will do this 500 times, so we get enough traces.</p><p>We first make a random string, then we convert the string into an array of the integer representation of the characters.</p><p>Then we just connect to the instance.</p><p>We convert the string to a bytes string, then we send it, with a timeout of 3.5 to recieve everything, then we close the connection.</p><p>We extract the integers with regex, and append it to the trace_list one by one, and when we are done with that, append the trace_list to the main_trace_array, basically creating an array inside an array.</p><p>When the loop is done, we just save the results into a numpy file:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">numpy</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="s">"trace_array.npy"</span><span class="p">,</span> <span class="n">main_trace_array</span><span class="p">)</span>
<span class="n">numpy</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="s">"textin_array.npy"</span><span class="p">,</span> <span class="n">main_input_array</span><span class="p">)</span>
</pre></table></code></div></div><p>so, we just have to run this to gather data, and when that’s done, we can just run <code class="language-plaintext highlighter-rouge">power.py</code> and see if it worked:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>❯ python3 power.py      
found byte 0
found byte 1
found byte 2
found byte 3
found byte 4
found byte 5
found byte 6
found byte 7
found byte 8
found byte 9
found byte 10
found byte 11
found byte 12
found byte 13
found byte 14
found byte 15

key: d3a5641a039fd87871f417094257285f
</pre></table></code></div></div><p>As stated in the challenge description we have to submit the key like this: <code class="language-plaintext highlighter-rouge">picoCTF{key}</code>, and we are done.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/picoctf2023/'>PicoCTF2023</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/cryptography/" class="post-tag no-text-decoration" >Cryptography</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PicoCTF%202023%20-%20PowerAnalysis:%20Part%201%20-%200x50D4&url=https%3A%2F%2F0x50d4.github.io%2Fblog%2Fposts%2Fpico-power-1%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/posts/pico-babygame01/">PicoCTF 2023 - Babygame01</a><li><a href="/blog/posts/pico-power-1/">PicoCTF 2023 - PowerAnalysis: Part 1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/linux/">Linux</a> <a class="post-tag" href="/blog/tags/cryptography/">Cryptography</a> <a class="post-tag" href="/blog/tags/hacking/">hacking</a> <a class="post-tag" href="/blog/tags/pwn/">Pwn</a> <a class="post-tag" href="/blog/tags/resources/">resources</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/posts/pico-babygame01/"><div class="card-body"> <em class="small" data-ts="1680649200" data-df="ll" > Apr 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PicoCTF 2023 - Babygame01</h3><div class="text-muted small"><p> Babygame01 gave us a game, that we could both run locally and with an instance, that we had to exploit, we got a terminal based game, where we had to move to a place with a character that was a “@”...</p></div></div></a></div><div class="card"> <a href="/blog/posts/pico-chrono/"><div class="card-body"> <em class="small" data-ts="1680649200" data-df="ll" > Apr 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PicoCTF 2023 - Chrono</h3><div class="text-muted small"><p> In chrono we get an instance we have to ssh into, and the task description just asks in what way do we automate a task to run at intervals on a linux server. On linux this is done by so called cron...</p></div></div></a></div><div class="card"> <a href="/blog/posts/pico-specialer/"><div class="card-body"> <em class="small" data-ts="1680649200" data-df="ll" > Apr 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PicoCTF 2023 - Specialer</h3><div class="text-muted small"><p> In specialer, we get given an instance that we have to ssh into, so let’s do that: ssh -p &amp;lt;port&amp;gt; ctf-player@saturn.picoctf.net and use the given password. We get a command line where we ca...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/posts/pico-specialer/" class="btn btn-outline-primary" prompt="Older"><p>PicoCTF 2023 - Specialer</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/linux/">Linux</a> <a class="post-tag" href="/blog/tags/cryptography/">Cryptography</a> <a class="post-tag" href="/blog/tags/hacking/">hacking</a> <a class="post-tag" href="/blog/tags/pwn/">Pwn</a> <a class="post-tag" href="/blog/tags/resources/">resources</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/sodasec">0x50D4</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/blog/app.js"></script>
